using System;
using System.Collections.Generic;
using System.Globalization;
using BT.RuntimeSerialization;
using UnityEngine;

namespace BT
{
    // Auto-generated by BTCodegen.cs. Do not edit by hand.
    public static class BTGeneratedNodeFactory
    {
        public enum NodeKind { Leaf = 0, Decorator = 1, Composite = 2 }

        public static NodeKind GetKind(string typeId)
        {
            switch (typeId)
            {
                case "BT.BTParallel":
                case "BT.BTRandom":
                case "BT.BTSelector":
                case "BT.BTSequence":
                    return NodeKind.Composite;
                case "BT.BTInverted":
                case "BT.BTProbability":
                case "BT.BTTimer":
                case "BT.BTinterval":
                    return NodeKind.Decorator;
                default: return NodeKind.Leaf;
            }
        }

        public static BTNode CreateComposite(string typeId, List<BTArgJson> args)
        {
            switch (typeId)
            {
                case "BT.BTParallel":
                {
                    var node = new global::BT.BTParallel((global::BT.ParallelType)GetInt(args, "type", 0));
                    node.ParallelType = (global::BT.ParallelType)GetInt(args, "ParallelType", 0);
                    return node;
                }
                case "BT.BTRandom": return new global::BT.BTRandom();
                case "BT.BTSelector": return new global::BT.BTSelector();
                case "BT.BTSequence": return new global::BT.BTSequence();
                default: return null;
            }
        }

        public static BTNode CreateDecorator(string typeId, List<BTArgJson> args, BTNode child)
        {
            switch (typeId)
            {
                case "BT.BTInverted": return new global::BT.BTInverted(child);
                case "BT.BTProbability": return new global::BT.BTProbability(GetInt(args, "Probability", 0), child);
                case "BT.BTTimer": return new global::BT.BTTimer(GetFloat(args, "timer", 0f), child);
                case "BT.BTinterval": return new global::BT.BTinterval(GetString(args, "databaseName", ""), GetFloat(args, "time", 0f), child);
                default: return null;
            }
        }

        public static BTNode CreateLeaf(string typeId, List<BTArgJson> args)
        {
            switch (typeId)
            {
                case "BT.BTWait":
                {
                    var node = new global::BT.BTWait();
                    node.interval = GetFloat(args, "interval", 0f);
                    return node;
                }
                case "BT.Nodes.BTCharacterInputNode":
                {
                    var node = new global::BT.Nodes.BTCharacterInputNode();
                    node.actionType = (global::BT.Nodes.BTCharacterInputNode.ActionType)GetInt(args, "actionType", 0);
                    node.boolValue = GetBool(args, "boolValue", false);
                    return node;
                }
                case "BT.Nodes.BTCharacterMoveNode":
                {
                    var node = new global::BT.Nodes.BTCharacterMoveNode();
                    node.vector2Value = GetVector2(args, "vector2Value", Vector2.zero);
                    return node;
                }
                case "BT.Nodes.BTCharacterMoveToPosition":
                {
                    var node = new global::BT.Nodes.BTCharacterMoveToPosition();
                    node.positionKey = GetString(args, "positionKey", "");
                    return node;
                }
                case "DebugAction":
                {
                    var node = new global::DebugAction();
                    node.logInfo = GetString(args, "logInfo", "");
                    node.type = (global::DebugAction.DebugActionType)GetInt(args, "type", 0);
                    return node;
                }
                default: return null;
            }
        }

        static string GetString(List<BTArgJson> args, string name, string defaultValue)
        {
            if (args == null) return defaultValue;
            for (var i = 0; i < args.Count; i++)
            {
                var a = args[i];
                if (a != null && a.name == name) return a.value ?? defaultValue;
            }
            return defaultValue;
        }

        static int GetInt(List<BTArgJson> args, string name, int defaultValue)
        {
            var s = GetString(args, name, null);
            if (string.IsNullOrEmpty(s)) return defaultValue;
            return int.TryParse(s, NumberStyles.Integer, CultureInfo.InvariantCulture, out var v) ? v : defaultValue;
        }

        static float GetFloat(List<BTArgJson> args, string name, float defaultValue)
        {
            var s = GetString(args, name, null);
            if (string.IsNullOrEmpty(s)) return defaultValue;
            return float.TryParse(s, NumberStyles.Float, CultureInfo.InvariantCulture, out var v) ? v : defaultValue;
        }

        static bool GetBool(List<BTArgJson> args, string name, bool defaultValue)
        {
            var s = GetString(args, name, null);
            if (string.IsNullOrEmpty(s)) return defaultValue;
            if (bool.TryParse(s, out var v)) return v;
            return int.TryParse(s, NumberStyles.Integer, CultureInfo.InvariantCulture, out var i) ? i != 0 : defaultValue;
        }

        static Vector2 GetVector2(List<BTArgJson> args, string name, Vector2 defaultValue)
        {
            var s = GetString(args, name, null);
            if (string.IsNullOrEmpty(s)) return defaultValue;
            var parts = s.Split(',');
            if (parts.Length < 2) return defaultValue;
            if (!float.TryParse(parts[0], NumberStyles.Float, CultureInfo.InvariantCulture, out var x)) return defaultValue;
            if (!float.TryParse(parts[1], NumberStyles.Float, CultureInfo.InvariantCulture, out var y)) return defaultValue;
            return new Vector2(x, y);
        }

        static Vector3 GetVector3(List<BTArgJson> args, string name, Vector3 defaultValue)
        {
            var s = GetString(args, name, null);
            if (string.IsNullOrEmpty(s)) return defaultValue;
            var parts = s.Split(',');
            if (parts.Length < 3) return defaultValue;
            if (!float.TryParse(parts[0], NumberStyles.Float, CultureInfo.InvariantCulture, out var x)) return defaultValue;
            if (!float.TryParse(parts[1], NumberStyles.Float, CultureInfo.InvariantCulture, out var y)) return defaultValue;
            if (!float.TryParse(parts[2], NumberStyles.Float, CultureInfo.InvariantCulture, out var z)) return defaultValue;
            return new Vector3(x, y, z);
        }
    }
}
